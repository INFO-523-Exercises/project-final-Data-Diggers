---
title: "visualizations"
author: "Data Diggers"
format: html
editor: visual
---

## Data Import
Introduction:

The emergence of advanced healthcare datasets has paved the way for groundbreaking research and development in the realm of medical science. In our pursuit of leveraging data-driven insights to address critical health issues, we have undertaken a comprehensive analysis of the Brain Stroke Dataset sourced from Kaggle. This dataset, offers a rich repository of patient records and associated attributes, presenting a unique opportunity for in-depth examination and exploration.

The primary impetus behind this project is the compelling need to revolutionize early stroke detection and refine risk assessment methodologies. Brain strokes, with their potentially devastating consequences, underscore the significance of timely intervention. By harnessing the power of data analytics, we aim to unravel patterns and correlations within the dataset that can contribute to the development of predictive models. These models, in turn, hold the potential to augment healthcare professionals' ability to identify individuals at risk of strokes at an early stage.

Our motivation stems from the realization that proactive measures in stroke prediction can significantly enhance patient care and facilitate more effective stroke prevention strategies. By delving into the intricacies of patient records and extracting meaningful insights, we aspire to contribute to the growing body of knowledge that aids medical practitioners in making informed decisions.
```{r}
brain <- read.csv("../data/brain_stroke.csv")
```

## Import Packages

```{r}
if (!require(pacman))
  install.packages("pacman")

pacman::p_load(flexdashboard,
              ggplot2,
               corrplot,
              dplyr)
```
## Questions:
1) How accurate are various prediction models for detecting a stroke in a patient?

2) How are certain lifestyle changes ranked on the basis of their importance in reducing the possibility of a stroke?

##Exploratory Data Analysis: 

## Correlations:

our data need to be numeric so lets temporarily remove some columns that we are not that curious about and lets change gender to 1 being male and 0 being female. We will also change smoking to be 0 for never smoking and 1 to smoking, unknown smoking will be counted as not smoking

```{r}
numeric_brain <- brain %>% select(-Residence_type, -work_type, -ever_married) %>%
  mutate(gender = if_else(gender == "Male", 1, 0)) %>%
  mutate(smoking_status = if_else(smoking_status == "never smoked", 0, 1))

```

Now we can create our correlation plot with all our variables

```{r}


numeric_data <- numeric_brain[, sapply(numeric_brain, is.numeric)]
correlation_matrix <- cor(numeric_data)

corrplot(correlation_matrix, method = "color")

```

We can see that age has the highest correlation with strokes but no single variable has a distinct correlation with stroke.

Age will be an important factor with our analysis so lets looks at it further

```{r}
ggplot(brain, aes(x = age, y = avg_glucose_level, color = factor(stroke))) +
  geom_point() +
  scale_color_manual(values = c("lightblue", "red"), , name = "stroke") +
  labs(title = "Age vs. Average Glucose Level") +
  ylab("Average Glucose Level") +
  xlab("Age")
```

It seems that a combination of age and glucose levels plays a big factor into having a stroke or not. As we notice a dense population of strokes in high age plus high glucose levels.

smoking did not show up as having any correlation with strokes but maybe that's because we combined not smoking and unknown. so lets separate the unknown smoking data from the rest to test.

```{r}
ggplot(brain, aes(x = smoking_status, fill = as.factor(stroke))) +
  geom_bar(stat = "count", position = "fill") +
  labs(title = "Percentage Stacked Bar Plot of Smoking Status and Stroke") +
  scale_fill_manual(values = c("lightblue",  "red"), name = "stroke") +
  xlab("smoking status") +
  ylab("percentage count")
```

interestingly we see that never smoked and smoke have the same percentage for having a stroke, so again individually smoking will not play a huge role in deciding strokes or not, but maybe with other variable that could change.

Lets take a look at disease correlation with stroke

```{r}
ggplot(brain, aes(x = hypertension, fill = as.factor(stroke))) +
  geom_bar(position = "fill", color = "black") +
  facet_grid(. ~ heart_disease) +
  labs(title = "Distribution of Stroke Status by hypertension and heart disease",
       x = "hypertension", y = "Percentage Count", fill = "Stroke") +
  scale_fill_manual(values = c("lightblue",  "red"))
```

There is definitely noticeable correlation here as having more preexisting conditions will increase the chance at having a stroke, while having none conditions significantly lowers the chance
